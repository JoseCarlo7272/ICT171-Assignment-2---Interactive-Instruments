<!DOCTYPE html>
<html>
<head>
<title>Interactive Instruments - Drums</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style type="text/css">

/*This section is for the home button, it describes how the button will look and function */
.home-btn {
    position: absolute;
    top: 20px;
    left: 20px;
    padding: 12px 24px;
    background-color: white;
    border: 2px solid black;
    border-radius: 0.62em;
    text-decoration: none;
    font-family: sans-serif;
    font-weight: bold;
    color: black;
    box-shadow: 3px 3px 0px rgba(0,0,0,0.8);
    z-index: 1000;
    transition: all 0.1s ease;
}

.home-btn:hover {
    background-color: #f2f2f2;
    transform: translateY(-2px);
    box-shadow: 3px 5px 0px rgba(0,0,0,0.8);
}

.home-btn:active {
    transform: translateY(3px);
    box-shadow: 0px 0px 0px rgba(0,0,0,0.8);
}

/* section css for the large box that covers the drums */
.drum-bg {
    border: 10px solid #4A4A4A; 
    position: absolute; 
    transform: translate(-50%, -50%); 
    left: 50%;
    top: 50%;
    padding: 2em;
    width: 80vw; 
    max-width: 800px;
    height: 60vh;
    min-height: 400px;
    border-radius: 0.62em;
    background-color: #D3D3D3; 
    user-select: none;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}

.drum-kit {
    position: relative; 
    width: 100%; 
    height: 100%;
    margin: 0 auto;
}

/* Drum padding */
.drum-pad {
    position: absolute;
    border-radius: 50%;
    cursor: pointer;
    background-color: #fafafa;
    border: 5px solid #333;
    box-shadow: 0 5px 10px rgba(0,0,0,0.3), inset 0 0 10px rgba(0,0,0,0.2);
    transition: all 0.05s ease;
    
    /* Text styling for key hints */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family: sans-serif;
    font-weight: bold;
    color: #333;
}

.drum-pad .key-hint {
    font-size: 1.5em;
    color: #000;
}
.drum-pad .sound-name {
    font-size: 0.8em;
    color: #555;
    margin-top: 5px;
}

/* active state for drums */
.drum-pad.active {
    transform: scale(0.95);
    box-shadow: 0 2px 5px rgba(0,0,0,0.3), inset 0 0 10px rgba(0,0,0,0.2);
    background-color: #eee;
}

/* cymbal styles */
.cymbal {
    background-color: #FFD700; 
    border-color: #DAA520; 
    box-shadow: 0 5px 10px rgba(0,0,0,0.3), inset 0 0 10px rgba(100,80,0,0.3);
}
.cymbal.active {
    background-color: #E6C200;
}


/* positions for pads and their sizes */
#kick {
    width: 150px;
    height: 150px;
    bottom: 5%;
    left: 50%;
    transform: translateX(-50%);
    background-color: #e0e0e0;
}

#snare {
    width: 130px;
    height: 130px;
    bottom: 20%;
    left: 25%;
}

#hi-hat {
    width: 100px;
    height: 100px;
    bottom: 45%;
    left: 15%;
}

#tom-1 {
    width: 100px;
    height: 100px;
    top: 20%;
    left: 35%;
}

#tom-2 {
    width: 100px;
    height: 100px;
    top: 20%;
    right: 35%;
}

#floor-tom {
    width: 140px;
    height: 140px;
    bottom: 20%;
    right: 20%;
}

#crash {
    width: 140px;
    height: 140px;
    top: 5%;
    left: 15%;
}

#ride {
    width: 150px;
    height: 150px;
    top: 5%;
    right: 15%;
}


/* background gradient */
@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}
body {
    min-height: 100vh;
    background: linear-gradient(-45deg, #FF6F61, #E8A87C, #4040a1, #A7226E);
    background-size: 400% 400%; 
    animation: gradientShift 15s ease infinite; 
    margin: 0; 
    overflow: hidden; 
}

</style>
</head>

<body>

<a href="Homepage.html" class="home-btn">🏠 Home</a>

<div class="drum-bg">
    <div class="drum-kit">
       
        <div class="drum-pad cymbal" id="crash">
            <span class="key-hint">Q</span>
            <span class="sound-name">Crash</span>
        </div>
        <div class="drum-pad cymbal" id="ride">
            <span class="key-hint">E</span>
            <span class="sound-name">Ride</span>
        </div>
        <div class="drum-pad cymbal" id="hi-hat">
            <span class="key-hint">W</span>
            <span class="sound-name">Hi-Hat</span>
        </div>

     
        <div class="drum-pad" id="tom-1">
            <span class="key-hint">R</span>
            <span class="sound-name">Tom 1</span>
        </div>
        <div class="drum-pad" id="tom-2">
            <span class="key-hint">T</span>
            <span class="sound-name">Tom 2</span>
        </div>
        <div class="drum-pad" id="snare">
            <span class="key-hint">S</span>
            <span class="sound-name">Snare</span>
        </div>
        <div class="drum-pad" id="floor-tom">
            <span class="key-hint">F</span>
            <span class="sound-name">Floor Tom</span>
        </div>
        <div class="drum-pad" id="kick">
            <span class="key-hint">K</span>
            <span class="sound-name">Kick</span>
        </div>
    </div>
</div>


<script>
// setting up the audio context
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();


// function in order to create white noise
let noiseBuffer;
function createWhiteNoise() {
    const bufferSize = audioCtx.sampleRate * 2; // this shows 2 seconds of white noise
    const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
    const output = buffer.getChannelData(0);

    for (let i = 0; i < bufferSize; i++) {
        output[i] = Math.random() * 2 - 1;
    }
    return buffer;
}
// This is to pregenerate the pre buffer
noiseBuffer = createWhiteNoise();

function playNoise(time, decay, filterType, filterFreq) {
    const noiseSource = audioCtx.createBufferSource();
    noiseSource.buffer = noiseBuffer;

    const filter = audioCtx.createBiquadFilter();
    filter.type = filterType;
    filter.frequency.value = filterFreq;

    const gainNode = audioCtx.createGain();
    gainNode.gain.setValueAtTime(0, time);
    gainNode.gain.linearRampToValueAtTime(0.7, time + 0.01); 
    gainNode.gain.exponentialRampToValueAtTime(0.001, time + decay);

    noiseSource.connect(filter);
    filter.connect(gainNode);
    gainNode.connect(audioCtx.destination);

    noiseSource.start(time);
    noiseSource.stop(time + decay + 0.1);
}

function playOscillator(time, decay, oscType, startFreq, endFreq = 0.01) {
    const osc = audioCtx.createOscillator();
    osc.type = oscType;
    
    const gainNode = audioCtx.createGain();
    gainNode.gain.setValueAtTime(0, time);
    gainNode.gain.linearRampToValueAtTime(0.7, time + 0.01); 
    gainNode.gain.exponentialRampToValueAtTime(0.001, time + decay); 

    // Pitch drop
    osc.frequency.setValueAtTime(startFreq, time);
    osc.frequency.exponentialRampToValueAtTime(endFreq, time + decay);

    osc.connect(gainNode);
    gainNode.connect(audioCtx.destination);
    
    osc.start(time);
    osc.stop(time + decay + 0.1);
}

// Every sound being mapped
const sounds = {
    'kick': () => {
        const now = audioCtx.currentTime;
        playOscillator(now, 0.15, 'sine', 120, 40);
    },
    'snare': () => {
        const now = audioCtx.currentTime;
        playNoise(now, 0.1, 'highpass', 1000); 
        playOscillator(now, 0.1, 'triangle', 250, 100); 
    },
    'hi-hat': () => {
        const now = audioCtx.currentTime;
        playNoise(now, 0.05, 'highpass', 7000); 
    },
    'tom-1': () => {
        const now = audioCtx.currentTime;
        playOscillator(now, 0.2, 'sine', 300, 100);
    },
    'tom-2': () => {
        const now = audioCtx.currentTime;
        playOscillator(now, 0.2, 'sine', 250, 80);
    },
    'floor-tom': () => {
        const now = audioCtx.currentTime;
        playOscillator(now, 0.25, 'sine', 180, 60);
    },
    'crash': () => {
        const now = audioCtx.currentTime;
        playNoise(now, 0.8, 'lowpass', 9000); 
    },
    'ride': () => {
        const now = audioCtx.currentTime;
        playNoise(now, 0.5, 'lowpass', 10000); 
    }
};

// event listeners

function playSound(soundId) {
    if (audioCtx.state === 'suspended') {
        audioCtx.resume();
    }
    
    const sound = sounds[soundId];
    if (sound) {
        sound();
      
        const pad = document.getElementById(soundId);
        pad.classList.add('active');
        setTimeout(() => {
            pad.classList.remove('active');
        }, 100); 
    }
}

// click listeners
document.querySelectorAll('.drum-pad').forEach(pad => {
    pad.addEventListener('mousedown', () => {
        playSound(pad.id);
    });
});

// key listeners
const keyMap = {
    'k': 'kick',
    's': 'snare',
    'w': 'hi-hat',
    'q': 'crash',
    'e': 'ride',
    'r': 'tom-1',
    't': 'tom-2',
    'f': 'floor-tom'
};

window.addEventListener('keydown', (e) => {
    const soundId = keyMap[e.key.toLowerCase()];
    if (soundId) {
        playSound(soundId);
    }
});

</script>

</body>
</html>